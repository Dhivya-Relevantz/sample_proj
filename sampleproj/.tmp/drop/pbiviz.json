{"visual":{"name":"testVisual","displayName":"Test Visual","guid":"testVisual22544EE367DD4C729999CAF187A81CE6","visualClassName":"Visual","version":"1.0.0.1","description":"A custom Power BI visual built with JavaScript/TypeScript","supportUrl":"https://community.fabric.microsoft.com/t5/Power-BI-forums/ct-p/powerbi","gitHubUrl":"https://github.com/Dhivya-Relevantz/sample_proj.git"},"author":{"name":"Dhivya Kannan","email":"dhivya.kannan@relevantz.com"},"apiVersion":"5.9.0","style":"style/visual.less","stringResources":{},"capabilities":{"dataRoles":[{"displayName":"Category Data","name":"category","kind":"Grouping"},{"displayName":"Measure Data","name":"measure","kind":"Measure"}],"objects":{"dataPoint":{"properties":{"defaultColor":{"type":{"fill":{"solid":{"color":true}}}},"showAllDataPoints":{"type":{"bool":true}},"fill":{"type":{"fill":{"solid":{"color":true}}}},"fillRule":{"type":{"fill":{}}},"fontSize":{"type":{"formatting":{"fontSize":true}}}}}},"dataViewMappings":[{"categorical":{"categories":{"for":{"in":"category"},"dataReductionAlgorithm":{"top":{}}},"values":{"select":[{"bind":{"to":"measure"}}]}}}],"privileges":[]},"content":{"js":"var testVisual22544EE367DD4C729999CAF187A81CE6;(()=>{\"use strict\";var e={639:(e,t,i)=>{function a(e,t){return{objectName:e,propertyName:t.name,selector:t.selector,altConstantValueSelector:t.altConstantSelector,instanceKind:t.instanceKind}}function s(e,t,i){return null==t||\"object\"==typeof t&&!t.solid?i:t.solid?{value:null==t?void 0:t.solid.color}:\"Dropdown\"===(null==e?void 0:e.type)&&e.items?e.items.find(e=>e.value==t):t}i.d(t,{D:()=>s,y:()=>a})},667:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(754);const s=class{constructor(e){this.localizationManager=e}populateFormattingSettingsModel(e,t){var i,s;const n=new e,l=null===(i=null==t?void 0:t.metadata)||void 0===i?void 0:i.objects;return l&&(null===(s=n.cards)||void 0===s||s.forEach(e=>{var t;e instanceof a.St&&(null===(t=e.topLevelSlice)||void 0===t||t.setPropertiesValues(l,e.name)),(e instanceof a.Tn?[e]:e.groups).forEach(t=>{var i,a,s,n;null===(i=t.topLevelSlice)||void 0===i||i.setPropertiesValues(l,e.name),null===(a=null==t?void 0:t.slices)||void 0===a||a.forEach(t=>{null==t||t.setPropertiesValues(l,e.name)}),null===(n=null===(s=null==t?void 0:t.container)||void 0===s?void 0:s.containerItems)||void 0===n||n.forEach(t=>{var i;null===(i=null==t?void 0:t.slices)||void 0===i||i.forEach(t=>{null==t||t.setPropertiesValues(l,e.name)})})})})),n}buildFormattingModel(e){const t={cards:[]};return e.cards.filter(({visible:e=!0})=>e).forEach(e=>{var i;const s={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,description:this.localizationManager&&e.descriptionKey?this.localizationManager.getDisplayName(e.descriptionKey):e.description,groups:[],uid:e.name+\"-card\",analyticsPane:e.analyticsPane},n=e.name;if(e.topLevelSlice){const t=e.topLevelSlice.getFormattingSlice(n,this.localizationManager);t.suppressDisplayName=!0,s.topLevelToggle=t}null===(i=e.onPreProcess)||void 0===i||i.call(e);const l=e instanceof a.Tn;(l?[e].filter(({visible:e=!0})=>e):e.groups.filter(({visible:e=!0})=>e)).forEach(e=>{const t=e.name+\"-group\",i={displayName:l?void 0:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,description:l?void 0:this.localizationManager&&e.descriptionKey?this.localizationManager.getDisplayName(e.descriptionKey):e.description,slices:[],uid:t,collapsible:e.collapsible,delaySaveSlices:e.delaySaveSlices,disabled:e.disabled,disabledReason:e.disabledReason};s.groups.push(i);const a={};if(e.container){const s=e.container,l=t+\"-container\",o={displayName:this.localizationManager&&s.displayNameKey?this.localizationManager.getDisplayName(s.displayNameKey):s.displayName,description:this.localizationManager&&s.descriptionKey?this.localizationManager.getDisplayName(s.descriptionKey):s.description,containerItems:[],uid:l};s.containerItems.forEach(e=>{const t=e.displayNameKey?e.displayNameKey:e.displayName,i=l+t,s={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,slices:[],uid:i};this.buildFormattingSlices({slices:e.slices,objectName:n,sliceNames:a,formattingSlices:s.slices}),o.containerItems.push(s)}),i.container=o}if(e.slices){if(e.topLevelSlice){const t=e.topLevelSlice.getFormattingSlice(n,this.localizationManager);t.suppressDisplayName=!0,(null==i.displayName?s:i).topLevelToggle=t}this.buildFormattingSlices({slices:e.slices,objectName:n,sliceNames:a,formattingSlices:i.slices})}}),s.revertToDefaultDescriptors=this.getRevertToDefaultDescriptor(e),t.cards.push(s)}),t}buildFormattingSlices({slices:e,objectName:t,sliceNames:i,formattingSlices:a}){null==e||e.filter(({visible:e=!0})=>e).forEach(e=>{const s=null==e?void 0:e.getFormattingSlice(t,this.localizationManager);s&&(void 0===i[e.name]?i[e.name]=0:(i[e.name]++,s.uid=`${s.uid}-${i[e.name]}`),a.push(s))})}getRevertToDefaultDescriptor(e){var t;const i={},s=[];let n,l=[];return e instanceof a.St&&e.topLevelSlice&&s.push(...null===(t=e.topLevelSlice)||void 0===t?void 0:t.getRevertToDefaultDescriptor(e.name)),(e instanceof a.Tn?[e].filter(({visible:e=!0})=>e):e.groups.filter(({visible:e=!0})=>e)).forEach(t=>{var a,o;n=this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,i,t.topLevelSlice),null===(o=null===(a=t.container)||void 0===a?void 0:a.containerItems)||void 0===o||o.forEach(t=>{l=l.concat(this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,i))}),s.push(...n.concat(l))}),s}getSlicesRevertToDefaultDescriptor(e,t,i,a){let s=[];return a&&(i[a.name]=!0,s=s.concat(a.getRevertToDefaultDescriptor(e))),null==t||t.forEach(t=>{t&&!i[t.name]&&(i[t.name]=!0,s=s.concat(t.getRevertToDefaultDescriptor(e)))}),s}}},674:(e,t,i)=>{i.d(t,{O:()=>s.A,z:()=>a});var a=i(754),s=i(667)},754:(e,t,i)=>{i.d(t,{Kx:()=>l,St:()=>o,Tn:()=>r,iB:()=>u,jF:()=>d,sk:()=>p});var a=i(639);class s{}class n extends s{}class l{}class o extends s{}class r extends n{}class c extends s{constructor(e){super(),Object.assign(this,e)}getFormattingSlice(e,t){const i=this.type,a=this.name,s={displayName:t&&this.displayNameKey?t.getDisplayName(this.displayNameKey):this.displayName,description:t&&this.descriptionKey?t.getDisplayName(this.descriptionKey):this.description,uid:e+\"-\"+a};return Object.assign(Object.assign({},s),{control:{type:i,properties:this.getFormattingComponent(e,t)}})}getFormattingComponent(e,t){return{descriptor:a.y(e,this),value:this.value}}getRevertToDefaultDescriptor(e){return[{objectName:e,propertyName:this.name}]}setPropertiesValues(e,t){var i;const s=null===(i=null==e?void 0:e[t])||void 0===i?void 0:i[this.name];this.value=a.D(this,s,this.value)}}class d extends c{constructor(e){super(e),this.type=\"ToggleSwitch\"}}class p extends c{constructor(e){super(e),this.type=\"ColorPicker\"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{defaultColor:this.defaultColor,isNoFillItemSupported:this.isNoFillItemSupported})}}class u extends c{constructor(e){super(e),this.type=\"NumUpDown\"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{options:this.options})}}},828:(e,t,i)=>{i.d(t,{b:()=>n});var a=i(674),s=i(831);class n{target;chatContainer;messagesArea;inputBox;sendButton;optionDropdown;fileInput;fileLabel;formattingSettings;formattingSettingsService;latestDataViews=[];constructor(e){this.formattingSettingsService=new a.O,this.target=e.element,this.target.innerHTML=\"\",this.chatContainer=document.createElement(\"div\"),this.chatContainer.className=\"chatbot-container\",this.messagesArea=document.createElement(\"div\"),this.messagesArea.className=\"chatbot-messages\",this.chatContainer.appendChild(this.messagesArea);const t=document.createElement(\"div\");t.className=\"chatbot-input-area\",this.inputBox=document.createElement(\"input\"),this.inputBox.type=\"text\",this.inputBox.placeholder=\"Ask your question...\",this.optionDropdown=document.createElement(\"select\"),this.optionDropdown.className=\"chatbot-dropdown\",[\"General\",\"Dataset\",\"File\"].forEach(e=>{const t=document.createElement(\"option\");t.value=e,t.text=e,this.optionDropdown.appendChild(t)}),this.fileInput=document.createElement(\"input\"),this.fileInput.type=\"file\",this.fileInput.style.display=\"none\",this.fileInput.onchange=()=>{this.fileInput.files&&this.fileInput.files.length>0?this.fileLabel.textContent=this.fileInput.files[0].name:this.fileLabel.textContent=\"No file chosen\"},this.fileLabel=document.createElement(\"span\"),this.fileLabel.textContent=\"No file chosen\";const i=document.createElement(\"button\");i.textContent=\"Choose File\",i.className=\"chatbot-send-btn\",i.onclick=()=>this.fileInput.click(),this.sendButton=document.createElement(\"button\"),this.sendButton.textContent=\"Send\",this.sendButton.className=\"chatbot-send-btn\",t.appendChild(this.inputBox),t.appendChild(this.optionDropdown),t.appendChild(i),t.appendChild(this.fileLabel),t.appendChild(this.sendButton),t.appendChild(this.fileInput),this.chatContainer.appendChild(t),this.target.appendChild(this.chatContainer),this.sendButton.onclick=()=>this.handleSend(),this.inputBox.onkeydown=e=>{\"Enter\"===e.key&&this.handleSend()}}async handleSend(){const e=this.inputBox.value.trim(),t=this.optionDropdown.value,i=this.fileInput.files&&this.fileInput.files.length>0?this.fileInput.files[0].name:null;if(!e&&\"File\"!==t)return;const a=document.createElement(\"div\");a.className=\"chatbot-message user\",a.textContent=`${t}: ${e}${i?\" | File: \"+i:\"\"}`,this.messagesArea.appendChild(a);const s=document.createElement(\"div\");s.className=\"chatbot-message bot\",s.textContent=\"Thinking...\",this.messagesArea.appendChild(s);let n=\"\";if(\"Dataset\"===t&&this.latestDataViews?.length>0){const e=this.latestDataViews[0]?.table?.columns.map(e=>e.displayName).join(\", \");n=`Columns: ${e}`}try{const a=await fetch(\"https://your-llm-api-endpoint\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({prompt:e,option:t,dataset:n,fileName:i})}),l=await a.json();\"bar_chart\"===l.type?s.innerHTML=this.renderBarChart(l.data):\"column_chart\"===l.type?s.innerHTML=this.renderColumnChart(l.data):\"pie_chart\"===l.type?s.innerHTML=this.renderPieChart(l.data):\"scatter_chart\"===l.type?s.innerHTML=this.renderScatterChart(l.data):s.innerHTML=`<b>LLM Response:</b> ${l.answer}`}catch(e){s.innerHTML=\"<b>Error:</b> Unable to get response from LLM.\"}this.inputBox.value=\"\",this.messagesArea.scrollTop=this.messagesArea.scrollHeight}renderBarChart(e){let t='<div class=\"bar-chart\">';return e.forEach(e=>{t+=`<div class=\"bar-row\">\\n            <span class=\"bar-label\">${e.label}</span>\\n            <div class=\"bar\" style=\"width:${5*e.value}px\">${e.value}</div>\\n        </div>`}),t+=\"</div>\",t}renderColumnChart(e){let t='<div class=\"column-chart\" style=\"display:flex;align-items:flex-end;height:120px;\">';return e.forEach(e=>{t+=`<div style=\"margin:0 8px;text-align:center;\">\\n            <div style=\"background:#26a69a;width:32px;height:${3*e.value}px;border-radius:8px 8px 0 0;\"></div>\\n            <div>${e.label}</div>\\n            <div>${e.value}</div>\\n        </div>`}),t+=\"</div>\",t}renderPieChart(e){let t=e.reduce((e,t)=>e+t.value,0),i='<div class=\"pie-chart\"><b>Pie Chart</b><ul>';return e.forEach(e=>{let a=(e.value/t*100).toFixed(1);i+=`<li>${e.label}: ${e.value} (${a}%)</li>`}),i+=\"</ul></div>\",i}renderScatterChart(e){let t='<div class=\"scatter-chart\"><b>Scatter Chart</b><table><tr><th>X</th><th>Y</th><th>Label</th></tr>';return e.forEach(e=>{t+=`<tr><td>${e.x}</td><td>${e.y}</td><td>${e.label||\"\"}</td></tr>`}),t+=\"</table></div>\",t}update(e){this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(s.S,e.dataViews[0]),this.latestDataViews=e.dataViews}getFormattingModel(){return this.formattingSettingsService.buildFormattingModel(this.formattingSettings)}}},831:(e,t,i)=>{i.d(t,{S:()=>o});var a=i(674),s=a.z.Tn,n=a.z.Kx;class l extends s{defaultColor=new a.z.sk({name:\"defaultColor\",displayName:\"Default color\",value:{value:\"\"}});showAllDataPoints=new a.z.jF({name:\"showAllDataPoints\",displayName:\"Show all\",value:!0});fill=new a.z.sk({name:\"fill\",displayName:\"Fill\",value:{value:\"\"}});fillRule=new a.z.sk({name:\"fillRule\",displayName:\"Color saturation\",value:{value:\"\"}});fontSize=new a.z.iB({name:\"fontSize\",displayName:\"Text Size\",value:12});name=\"dataPoint\";displayName=\"Data colors\";slices=[this.defaultColor,this.showAllDataPoints,this.fill,this.fillRule,this.fontSize]}class o extends n{dataPointCard=new l;cards=[this.dataPointCard]}}},t={};function i(a){var s=t[a];if(void 0!==s)return s.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,i),n.exports}i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var a={};i.r(a),i.d(a,{default:()=>o});var s=i(828),n=window.powerbi,l={name:\"testVisual22544EE367DD4C729999CAF187A81CE6_DEBUG\",displayName:\"Test Visual\",class:\"Visual\",apiVersion:\"5.9.0\",create:e=>{if(s.b)return new s.b(e);throw\"Visual instance not found\"},createModalDialog:(e,t,i)=>{const a=globalThis.dialogRegistry;e in a&&new a[e](t,i)},custom:!0};void 0!==n&&(n.visuals=n.visuals||{},n.visuals.plugins=n.visuals.plugins||{},n.visuals.plugins.testVisual22544EE367DD4C729999CAF187A81CE6_DEBUG=l);const o=l;testVisual22544EE367DD4C729999CAF187A81CE6=a})();","css":"p {\n  font-size: 20px;\n  font-weight: bold;\n}\np em {\n  background: yellow;\n  padding: 5px;\n}\n.chatbot-container {\n  border: 1px solid #e0e0e0;\n  border-radius: 8px;\n  padding: 16px;\n  background: #fff;\n  max-width: 700px;\n  margin: auto;\n  display: flex;\n  flex-direction: column;\n  height: 400px;\n}\n.chatbot-messages {\n  flex: 1;\n  overflow-y: auto;\n  margin-bottom: 12px;\n  background: #f9f9f9;\n  padding: 8px;\n  border-radius: 4px;\n  display: flex;\n  flex-direction: column;\n}\n.chatbot-message {\n  margin: 6px 0;\n  padding: 8px 12px;\n  border-radius: 16px;\n  max-width: 80%;\n  word-break: break-word;\n}\n.chatbot-message.user {\n  background: #e0f7fa;\n  align-self: flex-end;\n  text-align: right;\n}\n.chatbot-message.bot {\n  background: #c8e6c9;\n  align-self: flex-start;\n  text-align: left;\n}\n.chatbot-input-area {\n  display: flex;\n  gap: 8px;\n}\n.chatbot-input-area input {\n  flex: 1;\n  padding: 8px;\n  border-radius: 16px;\n  border: 1px solid #ccc;\n}\n.chatbot-dropdown {\n  padding: 8px;\n  border-radius: 16px;\n  border: 1px solid #ccc;\n}\n.chatbot-send-btn {\n  padding: 8px 16px;\n  border-radius: 16px;\n  border: none;\n  background: #26a69a;\n  color: #fff;\n  cursor: pointer;\n}\n.bar-chart {\n  margin: 12px 0;\n}\n.bar-row {\n  display: flex;\n  align-items: center;\n  margin-bottom: 6px;\n}\n.bar-label {\n  width: 60px;\n}\n.bar {\n  background: #26a69a;\n  color: #fff;\n  padding: 4px 8px;\n  border-radius: 8px;\n  margin-left: 8px;\n}\n.column-chart {\n  margin: 12px 0;\n}\n.pie-chart ul {\n  padding-left: 20px;\n}\n.scatter-chart table {\n  border-collapse: collapse;\n}\n.scatter-chart th,\n.scatter-chart td {\n  border: 1px solid #ccc;\n  padding: 4px 8px;\n}\n\n","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="},"visualEntryPoint":""}